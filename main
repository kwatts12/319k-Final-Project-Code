// ******* Possible Hardware I/O connections*******************
// Slide pot pin 1 connected to ground
// Slide pot pin 2 connected to PD2/AIN5
// Slide pot pin 3 connected to +3.3V
// fire button connected to PE0
// special weapon fire button connected to PE1
// 32*R resistor DAC bit 0 on PB0 (least significant bit)
// 16*R resistor DAC bit 1 on PB1
// 8*R resistor DAC bit 2 on PB2
// 4*R resistor DAC bit 1 on PB3
// 2*R resistor DAC bit 2 on PB4
// 1*R resistor DAC bit 3 on PB5 (most significant bit)
// LED on PB6
// LED on PB7

// Backlight (pin 10) connected to +3.3 V
// MISO (pin 9) unconnected
// SCK (pin 8) connected to PA2 (SSI0Clk)
// MOSI (pin 7) connected to PA5 (SSI0Tx)
// TFT_CS (pin 6) connected to PA3 (SSI0Fss)
// CARD_CS (pin 5) unconnected
// Data/Command (pin 4) connected to PA6 (GPIO), high for data, low for command
// RESET (pin 3) connected to PA7 (GPIO)
// VCC (pin 2) connected to +3.3 V
// Gnd (pin 1) connected to ground

#include <stdint.h>
#include "../inc/tm4c123gh6pm.h"
#include "PLL.h"
#include "ST7735.h"
#include "random.h"
#include "PLL.h"
#include "SlidePot.h"
#include "Images.h"
#include "UART.h"
#include "Timer0.h"
#include "Timer1.h"
#include "Sound.h"

SlidePot my(2000,0);

extern "C" void DisableInterrupts(void);
extern "C" void EnableInterrupts(void);
extern "C" void SysTick_Handler(void);

int lan; //0 = english //1 = spanish
int flag;
int AnyAlive;
int over = 0;
int yellowScore = 0;
int blueScore = 0;


// Creating a struct for the Sprite.
typedef enum {dead,alive} status_t;
class sprite{
private:
int32_t x;      // x coordinate
  int32_t y;      // y coordinate
int32_t vx, vy;
  const unsigned short *image; // ptr->image
const unsigned short *black;
  status_t life;            // dead/alive
uint32_t w;
uint32_t h;
uint32_t NeedDraw;

public:
sprite(){
life = dead;
}

void Init(int32_t ix, int32_t iy, int32_t ivx, int32_t ivy, const unsigned short *ii, const unsigned short *ib, status_t il, uint32_t iw, uint32_t ih, uint32_t iD){
x = ix;
y = iy;
vx = ivx;
vy = ivy;
image = ii;
black = ib;
life = il;
w = iw;
h = ih;
NeedDraw = iD;
}

void SlideMove(int32_t velo){
vx = velo;
x += vx;
if (x > 103){
x = 103;
}
if (x < 0){
x = 0;
}
NeedDraw = 1;
}

void BallMove(void){
if (over == 0){
if (x >= 123 || x <= 0){
vx *= -1;
}
else if (y >= 155){
vy *= -1;
}
x += vx;
y += vy;
NeedDraw = 1;
}
}

uint32_t x_pos(void){
return x;
}

uint32_t y_pos(void){
return y;
}

status_t IsAlive(void){
return life;
}

void NeedDr(void){
NeedDraw = 1;
}

void Kill(void){
life = dead;
}

void BallVelo(int32_t ix, int32_t iy){
vx *= ix;
vy *= iy;
}

void Draw(void){
if (NeedDraw){
if (life == alive){
ST7735_DrawBitmap(x-vx, y-vy, black, w, h);
ST7735_DrawBitmap(x, y, image, w, h);
}
else{
ST7735_DrawBitmap(x, y, black, w, h);
}
NeedDraw = 0;
}
}
};          
//typedef struct sprite sprite_t;



const unsigned short* brickop[] = {blue_block, turquoise_block, purple_block, pink_block};
const unsigned short* ballop[] = {blue_ball, yellow_ball};
const unsigned short* paddleop[] = {blue_paddle, yellow_paddle};
sprite bricks[96];
sprite final;
sprite balls[2];
sprite paddles[2];

void GameInit(void){
int i;
int j;
int k = 0;
flag = 0;
for (i = 0; i < 8; i++){
for (j = 0; j < 12; j++){
bricks[k].Init(j * 16, (i+1)*8, 0, 0, brickop[i%4], black_block, alive, 16, 8, 1);
//((j%4) + (i%4) % 4)
k++;
}
}
for (i = 0; i < 2; i++){
balls[i].Init((i*60)+25, 154, 0, -1, ballop[i], black_block, alive, 5, 5, 1);
}
for (i = 0; i < 2; i++){
paddles[i].Init((i*60)+20, 160, 0, 0, paddleop[i], black_block, alive, 25, 6, 1);
}
final.Init(80, 16, 0, 0, green_block, black_block, alive, 16, 8, 1);
}

void Hit(void){
for (int i = 0; i < 2; i++){
if (((balls[i].x_pos() + 5) == final.x_pos()) || ((balls[i].x_pos()) == final.x_pos() + 16) || ((balls[i].y_pos() + 5) == final.y_pos()) || ((balls[i].y_pos()) == (final.y_pos() + 8))){
over = 1;
}
if (over == 1){
if (i == 0){
blueScore++;
}
else{
yellowScore++;
}
NVIC_DIS0_R = 1<<21;
break;
}
}
}

void BrickDelete(uint32_t j){
if (bricks[j].IsAlive() == alive){
for (int i = 0; i < 2; i++){
if ((balls[i].x_pos() < bricks[j].x_pos() - 5) || (balls[i].x_pos() > bricks[j].x_pos() + 16) || (balls[i].y_pos() < bricks[j].y_pos() -5) || (balls[i].y_pos() > bricks[j].y_pos() + 8)){}
else if ((balls[i].x_pos() + 5 >= bricks[j].x_pos()) && (balls[i].x_pos() <= bricks[j].x_pos() + 16)){
bricks[j].Kill();
bricks[j].NeedDr();
balls[i].BallVelo(1, -1);
Sound_Play(crack, 26061);
}
else if ((balls[i].y_pos() + 5 >= bricks[j].y_pos()) || (balls[i].y_pos() <= bricks[j].y_pos() + 8)){
bricks[j].Kill();
bricks[j].NeedDr();
balls[i].BallVelo(-1, 1);
Sound_Play(crack, 26061);
}
}
}
}

void GameMove(void){
int i;
//AnyAlive = 0;
for (i = 0; i < 2; i++){
balls[i].BallMove();
}
for (i = 0; i < 96; i++){
BrickDelete(i);
}
Hit();
}

void GameDraw(void){
int i;
for (i = 0; i < 2; i++){
balls[i].Draw();
}
for (i = 0; i < 2; i++){
paddles[i].Draw();
}
for (i = 0; i < 96; i++){
bricks[i].Draw();
}
}

void Bounce(void){
for (int i = 0; i < 2; i++){
if (over == 1){
break;
}
for (int j = 0; j < 2; j++){
if (i == j){
if (balls[i].y_pos() == paddles[j].y_pos() + 6 || balls[i].y_pos() == paddles[j].y_pos() + 5){ //buffer for if it moves to fast -> paddle can be a little late
if (balls[i].x_pos() > paddles[j].y_pos() - 4 && balls[i].y_pos() < paddles[j].y_pos()){
balls[i].BallVelo(-1, -1);
}
else if (balls[i].x_pos() > paddles[j].x_pos() && balls[i].x_pos() < paddles[j].x_pos() + 10){
balls[i].BallVelo(-2, -1);
}
else if (balls[i].x_pos() > paddles[j].x_pos() + 10 && balls[i].x_pos() < paddles[j].x_pos() + 15){
balls[i].BallVelo(0, -1);
}
else if (balls[i].x_pos() > paddles[j].x_pos() + 15 && balls[i].x_pos() < paddles[j].x_pos() + 25){
balls[i].BallVelo(2, -1);
}
else if (balls[i].x_pos() > paddles[j].x_pos() + 25 && balls[i].x_pos() < paddles[j].x_pos() + 29){
balls[i].BallVelo(1, -1);
}
}
}
else if (i != j){
if (balls[i].y_pos() == paddles[j].y_pos() + 6){
if (balls[i].x_pos() > paddles[j].x_pos() - 4 && balls[i].x_pos() < paddles[j].x_pos() + 29){
over = 1;
}
}
}
if (balls[i].y_pos() > 154){
over = 1;
if (i == 0){
yellowScore++;
}
else{
blueScore++;
}
}
else if (over == 1){
if (j == 0){
yellowScore++;
}
else{
blueScore++;
}
}
if (over == 1){
NVIC_DIS0_R = 1<<21;
break;
}
}
}
}

void background(void){
  flag = 1; // semaphore
if (GPIO_PORTE_DATA_R == 0x04 || GPIO_PORTE_DATA_R == 0x02){
NVIC_DIS0_R = 1<<21;
while (GPIO_PORTE_DATA_R == 0x04 || GPIO_PORTE_DATA_R == 0x02){};
NVIC_EN0_R = 1<<21;
}
for (int i = 0; i < 2; i++){ //need to set up second slide pot
int32_t slide;
slide = ADC_In(i);
slide -= 1342;
slide /= 160;
paddles[i].SlideMove(slide);
}
//sample buttons
}

void GameTask(void){ //should be 30Hz
//sample
background();
GameMove();
//detect collisions
Bounce(); //add a conditional in bounce for efficiency
flag = 1;
}

void Delay10ms(uint32_t count){
  uint32_t i;
  for(i=0; i <count*32000; i++){
//for(int j=1; j<=25; j++){}
}
}

//void Delay100ms (uint32_t count);


uint32_t time = 0;
//volatile uint32_t flag;


void clock(void){
  time++;
}

void Init1(void){
PLL_Init(Bus80MHz);       // Bus clock is 80 MHz
  // TExaS_Init();
  Random_Init(1);
Sound_Init();
ADC_Init();
  Output_Init();
GameInit();
Delay10ms(50);
SYSCTL_RCGCGPIO_R |= 0x10;
for (int i = 0; i < 50; i++){}
GPIO_PORTE_DIR_R &= ~0x06;
GPIO_PORTE_DEN_R |= 0x06;
}

void Init2(void){
GameInit();
Delay10ms(50);
ST7735_FillScreen(0x0000);
GameDraw();
Sound_Play(start, 32669);
NVIC_EN0_R = 1<<21;
do{
while (flag == 0){}
flag = 0;
GameDraw();
}
while (over == 0);
}

int main(void){
  Init1();

ST7735_FillScreen(0x0000);
ST7735_DrawString(1, 1, (char*) "english", 0x07FF);
ST7735_DrawString(1, 2, (char*) "spanish", 0xF800);
while(GPIO_PORTE_DATA_R == 0x00){};
if (GPIO_PORTE_DATA_R == 0x04){
lan = 1;
}
else if (GPIO_PORTE_DATA_R == 0x02){
lan = 0;
}


ST7735_FillScreen(0x0000);
GameDraw();
Sound_Play(start, 32669);
  //Timer0_Init(&background,1600000); // 50 Hz
  Timer1A_Init(&GameTask,2666666, 1); // 30 Hz

//ST7735_DrawBitmap(80, 160, yellow_paddle, 25, 6);
//ST7735_DrawBitmap(20, 160, blue_paddle, 25, 6);
//ST7735_DrawBitmap(80, 110, yellow_ball, 5, 5);
//ST7735_DrawBitmap(20, 110, blue_ball, 5, 5);


  EnableInterrupts();

do{
while (flag == 0){}
flag = 0;
GameDraw();
}
while (over == 0);



/*ST7735_DrawBitmap(0, 8, blue_block, 16, 8);
ST7735_DrawBitmap(16, 8, turquoise_block, 16, 8);
ST7735_DrawBitmap(32, 8, purple_block, 16, 8);
ST7735_DrawBitmap(48, 8, pink_block, 16, 8);
ST7735_DrawBitmap(64, 8, blue_block, 16, 8);
ST7735_DrawBitmap(80, 8, turquoise_block, 16, 8);
ST7735_DrawBitmap(96, 8, purple_block, 16, 8);
ST7735_DrawBitmap(112, 8, pink_block, 16, 8);
ST7735_DrawBitmap(0, 16, turquoise_block, 16, 8);
ST7735_DrawBitmap(16, 16, purple_block, 16, 8);
ST7735_DrawBitmap(32, 16, pink_block, 16, 8);
ST7735_DrawBitmap(48, 16, blue_block, 16, 8);
ST7735_DrawBitmap(64, 16, turquoise_block, 16, 8);
ST7735_DrawBitmap(80, 16, purple_block, 16, 8);
ST7735_DrawBitmap(96, 16, pink_block, 16, 8);
ST7735_DrawBitmap(112, 16, blue_block, 16, 8);
ST7735_DrawBitmap(0, 24, purple_block, 16, 8);
ST7735_DrawBitmap(16, 24, pink_block, 16, 8);
ST7735_DrawBitmap(32, 24, blue_block, 16, 8);
ST7735_DrawBitmap(48, 24, turquoise_block, 16, 8);
ST7735_DrawBitmap(64, 24, purple_block, 16, 8);
ST7735_DrawBitmap(80, 24, pink_block, 16, 8);
ST7735_DrawBitmap(96, 24, blue_block, 16, 8);
ST7735_DrawBitmap(112, 24, turquoise_block, 16, 8);
ST7735_DrawBitmap(0, 32, pink_block, 16, 8);
ST7735_DrawBitmap(16, 32, blue_block, 16, 8);
ST7735_DrawBitmap(32, 32, turquoise_block, 16, 8);
ST7735_DrawBitmap(48, 32, purple_block, 16, 8);
ST7735_DrawBitmap(64, 32, pink_block, 16, 8);
ST7735_DrawBitmap(80, 32, blue_block, 16, 8);
ST7735_DrawBitmap(96, 32, turquoise_block, 16, 8);
ST7735_DrawBitmap(112, 32, purple_block, 16, 8);
ST7735_DrawBitmap(0, 40, blue_block, 16, 8);
ST7735_DrawBitmap(16, 40, turquoise_block, 16, 8);
ST7735_DrawBitmap(32, 40, purple_block, 16, 8);
ST7735_DrawBitmap(48, 40, pink_block, 16, 8);
ST7735_DrawBitmap(64, 40, blue_block, 16, 8);
ST7735_DrawBitmap(80, 40, turquoise_block, 16, 8);
ST7735_DrawBitmap(96, 40, purple_block, 16, 8);
ST7735_DrawBitmap(112, 40, pink_block, 16, 8);
ST7735_DrawBitmap(0, 48, turquoise_block, 16, 8);
ST7735_DrawBitmap(16, 48, purple_block, 16, 8);
ST7735_DrawBitmap(32, 48, pink_block, 16, 8);
ST7735_DrawBitmap(48, 48, blue_block, 16, 8);
ST7735_DrawBitmap(64, 48, turquoise_block, 16, 8);
ST7735_DrawBitmap(80, 48, purple_block, 16, 8);
ST7735_DrawBitmap(96, 48, pink_block, 16, 8);
ST7735_DrawBitmap(112, 48, blue_block, 16, 8);
ST7735_DrawBitmap(0, 56, purple_block, 16, 8);
ST7735_DrawBitmap(16, 56, pink_block, 16, 8);
ST7735_DrawBitmap(32, 56, blue_block, 16, 8);
ST7735_DrawBitmap(48, 56, turquoise_block, 16, 8);
ST7735_DrawBitmap(64, 56, purple_block, 16, 8);
ST7735_DrawBitmap(80, 56, pink_block, 16, 8);
ST7735_DrawBitmap(96, 56, blue_block, 16, 8);
ST7735_DrawBitmap(112, 56, turquoise_block, 16, 8);
ST7735_DrawBitmap(0, 64, pink_block, 16, 8);
ST7735_DrawBitmap(16, 64, blue_block, 16, 8);
ST7735_DrawBitmap(32, 64, turquoise_block, 16, 8);
ST7735_DrawBitmap(48, 64, purple_block, 16, 8);
ST7735_DrawBitmap(64, 64, pink_block, 16, 8);
ST7735_DrawBitmap(80, 64, blue_block, 16, 8);
ST7735_DrawBitmap(96, 64, turquoise_block, 16, 8);
ST7735_DrawBitmap(112, 64, purple_block, 16, 8);
ST7735_DrawBitmap(0, 72, blue_block, 16, 8);
ST7735_DrawBitmap(16, 72, turquoise_block, 16, 8);
ST7735_DrawBitmap(32, 72, purple_block, 16, 8);
ST7735_DrawBitmap(48, 72, pink_block, 16, 8);
ST7735_DrawBitmap(64, 72, blue_block, 16, 8);
ST7735_DrawBitmap(80, 72, turquoise_block, 16, 8);
ST7735_DrawBitmap(96, 72, purple_block, 16, 8);
ST7735_DrawBitmap(112, 72, pink_block, 16, 8);
ST7735_DrawBitmap(0, 80, turquoise_block, 16, 8);
ST7735_DrawBitmap(16, 80, purple_block, 16, 8);
ST7735_DrawBitmap(32, 80, pink_block, 16, 8);
ST7735_DrawBitmap(48, 80, blue_block, 16, 8);
ST7735_DrawBitmap(64, 80, turquoise_block, 16, 8);
ST7735_DrawBitmap(80, 80, purple_block, 16, 8);
ST7735_DrawBitmap(96, 80, pink_block, 16, 8);
ST7735_DrawBitmap(112, 80, blue_block, 16, 8);
ST7735_DrawBitmap(0, 88, purple_block, 16, 8);
ST7735_DrawBitmap(16, 88, pink_block, 16, 8);
ST7735_DrawBitmap(32, 88, blue_block, 16, 8);
ST7735_DrawBitmap(48, 88, turquoise_block, 16, 8);
ST7735_DrawBitmap(64, 88, purple_block, 16, 8);
ST7735_DrawBitmap(80, 88, pink_block, 16, 8);
ST7735_DrawBitmap(96, 88, blue_block, 16, 8);
ST7735_DrawBitmap(112, 88, turquoise_block, 16, 8);
ST7735_DrawBitmap(0, 96, pink_block, 16, 8);
ST7735_DrawBitmap(16, 96, blue_block, 16, 8);
ST7735_DrawBitmap(32, 96, turquoise_block, 16, 8);
ST7735_DrawBitmap(48, 96, purple_block, 16, 8);
ST7735_DrawBitmap(64, 96, pink_block, 16, 8);
ST7735_DrawBitmap(80, 96, blue_block, 16, 8);
ST7735_DrawBitmap(96, 96, turquoise_block, 16, 8);
ST7735_DrawBitmap(112, 96, purple_block, 16, 8);

  ST7735_DrawBitmap(52, 159, PlayerShip0, 18,8); // player ship middle bottom
  ST7735_DrawBitmap(53, 151, Bunker0, 18,5);
  ST7735_DrawBitmap(0, 9, SmallEnemy10pointA, 16,10);
  ST7735_DrawBitmap(20,9, SmallEnemy10pointB, 16,10);
  ST7735_DrawBitmap(40, 9, SmallEnemy20pointA, 16,10);
  ST7735_DrawBitmap(80, 9, SmallEnemy30pointA, 16,10);
  ST7735_DrawBitmap(100, 9, SmallEnemy30pointB, 16,10);
*/

 /* while(bill.life == alive){
    while(flag==0){};
    flag = 0;
    ST7735_DrawBitmap(bill.x,bill.y,bill.image,16,10);
  }*/


if (lan == 0){
if (yellowScore < 3 && blueScore < 3){
Sound_Play(vulture, 13169);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"ROUND OVER");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"SCORE:");
ST7735_SetCursor(1, 3);
ST7735_OutUDec(yellowScore);
ST7735_SetCursor(3, 3);
ST7735_OutChar('-');
ST7735_SetCursor(5, 3);
ST7735_OutUDec(blueScore);
Delay10ms(500);
over = 0;
Init2();
}

if (yellowScore < 3 && blueScore < 3){
Sound_Play(vulture, 13169);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"ROUND OVER");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"SCORE:");
ST7735_SetCursor(1, 3);
ST7735_OutUDec(yellowScore);
ST7735_SetCursor(3, 3);
ST7735_OutChar('-');
ST7735_SetCursor(5, 3);
ST7735_OutUDec(blueScore);
Delay10ms(500);
over = 0;
Init2();
}

if (yellowScore < 3 && blueScore < 3){
Sound_Play(vulture, 13169);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"ROUND OVER");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"SCORE:");
ST7735_SetCursor(1, 3);
ST7735_OutUDec(yellowScore);
ST7735_SetCursor(3, 3);
ST7735_OutChar('-');
ST7735_SetCursor(5, 3);
ST7735_OutUDec(blueScore);
Delay10ms(500);
over = 0;
Init2();
}

if (yellowScore < 3 && blueScore < 3){
Sound_Play(vulture, 13169);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"ROUND OVER");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"SCORE:");
ST7735_SetCursor(1, 3);
ST7735_OutUDec(yellowScore);
ST7735_SetCursor(3, 3);
ST7735_OutChar('-');
ST7735_SetCursor(5, 3);
ST7735_OutUDec(blueScore);
Delay10ms(500);
over = 0;
Init2();
}

if (yellowScore < 3 && blueScore < 3){
Sound_Play(vulture, 13169);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"ROUND OVER");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"SCORE:");
ST7735_SetCursor(1, 3);
ST7735_OutUDec(yellowScore);
ST7735_SetCursor(3, 3);
ST7735_OutChar('-');
ST7735_SetCursor(5, 3);
ST7735_OutUDec(blueScore);
Delay10ms(500);
over = 0;
Init2();
}

if (yellowScore == 3){
Sound_Play(GAMEOVER, 94528);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"GAME OVER");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"YELLOW WINS");
}
if (blueScore == 3){
Sound_Play(GAMEOVER, 94528);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"GAME OVER");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"BLUE WINS");
}
}

else{
if (yellowScore < 3 && blueScore < 3){
Sound_Play(vulture, 13169);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"HALTAR");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"PUNTAJE:");
ST7735_SetCursor(1, 3);
ST7735_OutUDec(yellowScore);
ST7735_SetCursor(3, 3);
ST7735_OutChar('-');
ST7735_SetCursor(5, 3);
ST7735_OutUDec(blueScore);
Delay10ms(500);
over = 0;
Init2();
}

if (yellowScore < 3 && blueScore < 3){
Sound_Play(vulture, 13169);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"HALTAR");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"PUNTAJE:");
ST7735_SetCursor(1, 3);
ST7735_OutUDec(yellowScore);
ST7735_SetCursor(3, 3);
ST7735_OutChar('-');
ST7735_SetCursor(5, 3);
ST7735_OutUDec(blueScore);
Delay10ms(500);
over = 0;
Init2();
}

if (yellowScore < 3 && blueScore < 3){
Sound_Play(vulture, 13169);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"HALTAR");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"PUNTAJE:");
ST7735_SetCursor(1, 3);
ST7735_OutUDec(yellowScore);
ST7735_SetCursor(3, 3);
ST7735_OutChar('-');
ST7735_SetCursor(5, 3);
ST7735_OutUDec(blueScore);
Delay10ms(500);
over = 0;
Init2();
}

if (yellowScore < 3 && blueScore < 3){
Sound_Play(vulture, 13169);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"HALTAR");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"PUNTAJE:");
ST7735_SetCursor(1, 3);
ST7735_OutUDec(yellowScore);
ST7735_SetCursor(3, 3);
ST7735_OutChar('-');
ST7735_SetCursor(5, 3);
ST7735_OutUDec(blueScore);
Delay10ms(500);
over = 0;
Init2();
}

if (yellowScore < 3 && blueScore < 3){
Sound_Play(vulture, 13169);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"HALTAR");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"PUNTAJE:");
ST7735_SetCursor(1, 3);
ST7735_OutUDec(yellowScore);
ST7735_SetCursor(3, 3);
ST7735_OutChar('-');
ST7735_SetCursor(5, 3);
ST7735_OutUDec(blueScore);
Delay10ms(500);
over = 0;
Init2();
}

if (yellowScore == 3){
Sound_Play(GAMEOVER, 94528);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"FINALIZAR");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"VICTORIA AMARILLA");
}
if (blueScore == 3){
Sound_Play(GAMEOVER, 94528);
ST7735_FillScreen(0x0000);
ST7735_SetCursor(1, 1);
ST7735_OutString((char*)"FINALIZAR");
ST7735_SetCursor(1, 2);
ST7735_OutString((char*)"VICTORIA AZUL");
}
}

  ST7735_FillScreen(0x0000);            // set screen to black
  ST7735_SetCursor(1, 1);
  ST7735_OutString((char*)"GAME OVER");
  ST7735_SetCursor(1, 2);
  ST7735_SetTextColor(ST7735_WHITE);
  ST7735_OutString((char*)"Nice try,");
  ST7735_SetCursor(1, 3);
  ST7735_OutString((char*)"Earthling!");
  ST7735_SetCursor(2, 4);
  ST7735_SetTextColor(ST7735_WHITE);
  while(1){
    while(flag==0){};
    flag = 0;
    ST7735_SetCursor(2, 4);
    ST7735_OutUDec(time);
  }

}
